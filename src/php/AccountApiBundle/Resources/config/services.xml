<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
        <defaults public="true" />

        <prototype namespace="Frontastic\Common\AccountApiBundle\Command\" resource="../../Command" autoconfigure="true" />

        <service id="Frontastic\Common\AccountApiBundle\Domain\AccountApiFactory">
            <argument type="service" id="service_container" />
            <argument type="service">
                <service class="Doctrine\Common\Cache\ApcuCache" />
            </argument>
            <argument type="tagged" tag="accountApi.lifecycleEventListener" />
        </service>

        <service id="Frontastic\Common\AccountApiBundle\Domain\AccountApi">
            <factory
                service="Frontastic\Common\AccountApiBundle\Domain\AccountApiFactory"
                method="factor">
            </factory>
            <argument type="expression">service('Frontastic\\Catwalk\\ApiCoreBundle\\Domain\\Context').customer</argument>
        </service>

        <service id="Frontastic\Common\AccountApiBundle\Security\AccountProvider">
            <argument type="service" id="Frontastic\Common\AccountApiBundle\Domain\AccountService" />
        </service>

        <service id="Frontastic\Common\AccountApiBundle\Security\Authenticator">
            <argument type="service" id="Frontastic\Common\AccountApiBundle\Domain\AccountService" />
            <argument type="service" id="frontastic.catwalk.cart_api" />
            <argument type="service" id="Frontastic\Catwalk\ApiCoreBundle\Domain\ContextService" />
        </service>

        <service id="Frontastic\Common\AccountApiBundle\Security\LogoutSuccessHandler" />

        <service id="Frontastic\Common\AccountApiBundle\Domain\AccountService">
            <argument type="service" id="Frontastic\Common\AccountApiBundle\Domain\AccountApi" />
            <argument type="service" id="Frontastic\Common\CoreBundle\Domain\Mailer" />
        </service>

        <service id="frontastic.user.guard_handler" alias="Symfony\Component\Security\Guard\GuardAuthenticatorHandler" />
    </services>
</container>
